<div [ktBusy]="isLoading">
    <kt-portlet>
      <kt-portlet-header [sticky]="false" [title]="title" [class]="'card-head-lg'"></kt-portlet-header>
      <!--begin::Form-->
  
      <form [formGroup]="bidEvaluationForm" (ngSubmit)="onSubmit()" class="kt-form kt-form--label-align-right" #formDirective="ngForm">
        <div class="kt-portlet__body">
          <div class="kt-form__section kt-form__section--first">
  
            <div class="col-md-12 col-sm-12 col-lg-12">
              <div class="row mt-1 mb-0">
                <div class="col-lg-3 col-sm-3 col-md-3">
                  <div class="form-group kt-form__group mb-0">
                    <label class="col-form-label pt-0">Procuring Agency Name:</label>
                    <kt-input-field 
                      id="bid_name"
                      formControlName="name" 
                      matFormFieldClass="full-width" 
                      placeholder="Name"
                      (blurEvent)="logValidationErrors(bidEvaluationForm, formErrors, validationMessages)"
                      [errorMessage]="[{ condition : formErrors.name , error : formErrors.name }]">
                    </kt-input-field>
                  </div>
                </div>
  
                <div class="col-lg-3 col-sm-3 col-md-3">
                  <div class="form-group kt-form__group mb-0">
                    <label class="col-form-label pt-0">Procurement Method:</label>
                    <kt-input-field 
                      id="bid_method"
                      formControlName="methodOfProcurement" 
                      matFormFieldClass="full-width" 
                      placeholder="Method"
                      (blurEvent)="logValidationErrors(bidEvaluationForm, formErrors, validationMessages)"
                      [errorMessage]="[{ condition : formErrors.methodOfProcurement , error : formErrors.methodOfProcurement }]">
                    </kt-input-field>
                  </div>
                </div>

                <div class="col-lg-3 col-sm-3 col-md-3">
                  <div class="form-group kt-form__group mb-0">
                    <label class="col-form-label pt-0">Procurement Title:</label>
                    <kt-input-field 
                      id="bid_title"
                      formControlName="title" 
                      matFormFieldClass="full-width" 
                      placeholder="Title"
                      (blurEvent)="logValidationErrors(bidEvaluationForm, formErrors, validationMessages)"
                      [errorMessage]="[{ condition : formErrors.title , error : formErrors.title }]">
                    </kt-input-field>
                  </div>
                </div>

                <div class="col-lg-3 col-sm-3 col-md-3">
                  <div class="form-group kt-form__group mb-0">
                    <label class="col-form-label pt-0">Tendor Inquiry Number:</label>
                    <kt-input-field 
                      id="bid_inquiry"
                      formControlName="tendorInquiryNumber" 
                      matFormFieldClass="full-width" 
                      placeholder="Inquiry Number"
                      (blurEvent)="logValidationErrors(bidEvaluationForm, formErrors, validationMessages)"
                      [errorMessage]="[{ condition : formErrors.tendorInquiryNumber , error : formErrors.tendorInquiryNumber }]">
                    </kt-input-field>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-lg-3 col-sm-3 col-md-3">
                  <div class="form-group kt-form__group mb-0">
                    <label class="col-form-label pt-0">PPRA Ref. No. (TSE):</label>
                    <kt-input-field 
                      id="bid_refNo"
                      formControlName="refNo" 
                      matFormFieldClass="full-width" 
                      placeholder="Ref No"
                      (blurEvent)="logValidationErrors(bidEvaluationForm, formErrors, validationMessages)"
                      [errorMessage]="[{ condition : formErrors.refNo , error : formErrors.refNo }]">
                    </kt-input-field>
                  </div>
                </div>

                <div class="col-lg-3 col-sm-3 col-md-3">
                  <div class="form-group kt-form__group mb-0">
                    <label class="col-form-label pt-0">Bid Received Number:</label>
                    <kt-input-field 
                      id="bid_bidNumber"
                      formControlName="numberOfBids" 
                      matFormFieldClass="full-width" 
                      placeholder="Number Of Bids"
                      (blurEvent)="logValidationErrors(bidEvaluationForm, formErrors, validationMessages)"
                      [errorMessage]="[{ condition : formErrors.numberOfBids , error : formErrors.numberOfBids }]">
                    </kt-input-field>
                  </div>
                </div>

                <div class="col-lg-3 col-sm-3 col-md-3">
                  <div class="form-group kt-form__group mb-0">
                    <label class="col-form-label pt-0">Bid Opening Date:</label>
                      <kt-date-input
                        formControlName="dateOfOpeningBid"
                        placeholder="Select Opening Date"
                        matFormFieldClass="full-width"
                        (blurEvent)="logValidationErrors(bidEvaluationForm, formErrors, validationMessages)"
                        [errorMessage]="formErrors.dateOfOpeningBid">
                      </kt-date-input>
                  </div>
                </div>

                <div class="col-lg-3 col-sm-3 col-md-3">
                    <div class="form-group kt-form__group mb-0">
                      <label class="col-form-label pt-0">Bid Closing Date:</label>
                        <kt-date-input
                          formControlName="dateOfClosingBid"
                          placeholder="Select Closing Date"
                          matFormFieldClass="full-width"
                          (blurEvent)="logValidationErrors(bidEvaluationForm, formErrors, validationMessages)"
                          [errorMessage]="formErrors.dateOfClosingBid">
                        </kt-date-input>
                    </div>
                  </div>
              </div>

              <div class="row">
                <div class="col-lg-6 col-sm-6 col-md-6">
                  <div class="form-group kt-form__group mb-0">
                    <label class="col-form-label pt-0">Bid Evaluation Criteria:</label>
                    <kt-input-field 
                      id="bid_criteria"
                      formControlName="bidEvaluationCriteria" 
                      matFormFieldClass="full-width" 
                      placeholder="Bid Evaluation Criteria"
                      (blurEvent)="logValidationErrors(bidEvaluationForm, formErrors, validationMessages)"
                      [errorMessage]="[{ condition : formErrors.bidEvaluationCriteria , error : formErrors.bidEvaluationCriteria }]">
                    </kt-input-field>
                  </div>
                </div>

                <div class="col-lg-6 col-sm-6 col-md-6">
                  <div class="form-group kt-form__group mb-0">
                    <label class="col-form-label pt-0">Lowest Evaluated Bidder:</label>
                    <kt-input-field 
                      id="bid_lowestBidder"
                      formControlName="lowestEvaluatedBidder" 
                      matFormFieldClass="full-width" 
                      placeholder="Lowest Evaluated Bidder"
                      (blurEvent)="logValidationErrors(bidEvaluationForm, formErrors, validationMessages)"
                      [errorMessage]="[{ condition : formErrors.lowestEvaluatedBidder , error : formErrors.lowestEvaluatedBidder }]">
                    </kt-input-field>
                  </div>
                </div>
              </div>

              <div class="row mt-5">
                <div class="col-lg-12 col-md-12 col-sm-12">
                  <div class="">
                    <ng-container formArrayName="bidEvaluationLines">
                      <div class="table-responsive">
                        <mat-table #table [dataSource]="bidEvaluationForm.get('bidEvaluationLines')['controls']">
                          <!-- Account Column -->
                          <ng-container matColumnDef="nameOfBider">
                            <mat-header-cell *matHeaderCellDef class="flex-1"> Bidder Name</mat-header-cell>
                            <mat-cell *matCellDef="let element;  let i = index" [formGroup]="element" class="flex-1">
                              <div class="col-lg-12 col-sm-12 mt-2">
                                <kt-input-field formControlName="nameOfBider" [id]="'bid_bidder' + i"
                                  matFormFieldClass="mobile-label full-width" placeholder="Enter Name"
                                 
                                  (blurEvent)="logValidationErrors(this.bidEvaluationForm, formErrors, validationMessages)"
                                  [errorMessage]="[{ condition : element.controls.nameOfBider.errors?.required &&
                                                                      element.controls.nameOfBider.touched , 
                                                          error : 'Name is required.' }]">
                                </kt-input-field>
                              </div>
                            </mat-cell>
                          </ng-container>
                          <!--Partner Column-->
                          <ng-container matColumnDef="technicalTotal">
                            <mat-header-cell *matHeaderCellDef class="flex-1"> Technical Total</mat-header-cell>
                            <mat-cell *matCellDef="let element;  let i = index" [formGroup]="element" class="flex-1">
                              <div class="col-lg-12 col-sm-12 mt-2">
                                <kt-input-field formControlName="technicalTotal" [id]="'bid_techTotal' + i"
                                  matFormFieldClass="mobile-label full-width" placeholder="Enter Total" type="number"
                                 
                                  (blurEvent)="logValidationErrors(this.bidEvaluationForm, formErrors, validationMessages)"
                                  [errorMessage]="[{ condition : element.controls.technicalTotal.errors?.required &&
                                                                      element.controls.technicalTotal.touched , 
                                                          error : 'Total is required.' },
                                                        { condition : element.controls.technicalTotal.errors?.min &&
                                                                      element.controls.technicalTotal.touched , 
                                                          error : 'Minimum value is zero.' }]">
                                </kt-input-field>
                              </div>
                            </mat-cell>
                          </ng-container>
                          <ng-container matColumnDef="technicalObtain">
                            <mat-header-cell *matHeaderCellDef class="flex-1"> Technical Obtain</mat-header-cell>
                            <mat-cell *matCellDef="let element;  let i = index" [formGroup]="element" class="flex-1">
                              <div class="col-lg-12 col-sm-12 mt-2">
                                <kt-input-field formControlName="technicalObtain" [id]="'bid_techObtain' + i"
                                  matFormFieldClass="mobile-label full-width" placeholder="Enter Obtain No" type="number"
                                 
                                  (blurEvent)="logValidationErrors(this.bidEvaluationForm, formErrors, validationMessages)"
                                  [errorMessage]="[{ condition : element.controls.technicalObtain.errors?.required &&
                                                                      element.controls.technicalObtain.touched , 
                                                          error : 'Obtain No is required.' },
                                                        { condition : element.controls.technicalObtain.errors?.min &&
                                                                      element.controls.technicalObtain.touched , 
                                                          error : 'Minimum value is zero.' }]">
                                </kt-input-field>
                              </div>
                            </mat-cell>
                          </ng-container>
                          <ng-container matColumnDef="financialTotal">
                            <mat-header-cell *matHeaderCellDef class="flex-1"> Financial Total</mat-header-cell>
                            <mat-cell *matCellDef="let element;  let i = index" [formGroup]="element" class="flex-1">
                              <div class="col-lg-12 col-sm-12 mt-2">
                                <kt-input-field formControlName="financialTotal" [id]="'bid_finanTotal' + i"
                                  matFormFieldClass="mobile-label full-width" placeholder="Ente Total" type="number"
                                 
                                  (blurEvent)="logValidationErrors(this.bidEvaluationForm, formErrors, validationMessages)"
                                  [errorMessage]="[{ condition : element.controls.financialTotal.errors?.required &&
                                                                      element.controls.financialTotal.touched , 
                                                          error : 'Total is required.' },
                                                        { condition : element.controls.financialTotal.errors?.min &&
                                                                      element.controls.financialTotal.touched , 
                                                          error : 'Minimum value is zero.' }]">
                                </kt-input-field>
                              </div>
                            </mat-cell>
                          </ng-container>
                          <!-- Description Column -->
                          <ng-container matColumnDef="financialObtain">
                            <mat-header-cell *matHeaderCellDef class="flex-1"> Financial Obtain</mat-header-cell>
                            <mat-cell *matCellDef="let element;  let i = index" [formGroup]="element" class="flex-1">
                              <div class="col-lg-12 col-sm-12 mt-2">
                                <kt-input-field formControlName="financialObtain" [id]="'bid_finanObtain' + i"
                                  matFormFieldClass="mobile-label full-width" placeholder="Enter Obtain No" type="number"
                                 
                                  (blurEvent)="logValidationErrors(this.bidEvaluationForm, formErrors, validationMessages)"
                                  [errorMessage]="[{ condition : element.controls.financialObtain.errors?.required &&
                                                                      element.controls.financialObtain.touched , 
                                                          error : 'Obtain No is required.' },
                                                        { condition : element.controls.financialObtain.errors?.min &&
                                                                      element.controls.financialObtain.touched , 
                                                          error : 'Minimum value is zero.' }]">
                                </kt-input-field>
                              </div>
                            </mat-cell>
                          </ng-container>
                          <ng-container matColumnDef="evaluatedCost">
                            <mat-header-cell *matHeaderCellDef class="flex-1"> Evaluated Cost</mat-header-cell>
                            <mat-cell *matCellDef="let element;  let i = index" [formGroup]="element" class="flex-1">
                              <div class="col-lg-12 col-sm-12 mt-2">
                                <kt-input-field formControlName="evaluatedCost" [id]="'bid_cost' + i"
                                  matFormFieldClass="mobile-label full-width" placeholder="Enter Cost" type="number"
                                 
                                  (blurEvent)="logValidationErrors(this.bidEvaluationForm, formErrors, validationMessages)"
                                  [errorMessage]="[{ condition : element.controls.evaluatedCost.errors?.required &&
                                                                      element.controls.evaluatedCost.touched , 
                                                          error : 'Cost is required.' },
                                                        { condition : element.controls.evaluatedCost.errors?.min &&
                                                                      element.controls.evaluatedCost.touched , 
                                                          error : 'Minimum value is zero.' }]">
                                </kt-input-field>
                              </div>
                            </mat-cell>
                          </ng-container>
                          <ng-container matColumnDef="rule">
                            <mat-header-cell *matHeaderCellDef class="flex-2"> Rule</mat-header-cell>
                            <mat-cell *matCellDef="let element;  let i = index" [formGroup]="element" class="flex-2">
                              <div class="col-lg-12 col-sm-12 mt-2">
                                <kt-input-field formControlName="rule" [id]="'bid_rule' + i"
                                  matFormFieldClass="mobile-label full-width" placeholder="Enter Rule" 
                                  (blurEvent)="logValidationErrors(this.bidEvaluationForm, formErrors, validationMessages)"
                                  [errorMessage]="[{ condition : element.controls.rule.errors?.required &&
                                                                      element.controls.rule.touched , 
                                                          error : 'Rule is required.' }]">
                                </kt-input-field>
                              </div>
                            </mat-cell>
                          </ng-container>
                          <!-- Action Column -->
                          <ng-container matColumnDef="action">
                            <mat-header-cell *matHeaderCellDef class="flex-1">Action</mat-header-cell>
                            <mat-cell *matCellDef="let element;  let i = index" [formGroup]="element" class="flex-1">
                            
                              <button class="  app-remove-btn" type="button" [id]="'bid_remove_' + i"
                                (click)="removeBidEvaluationLineClick(i)">
                                <i class="fas fa-trash" aria-hidden="true"></i>
                              </button>
                            </mat-cell>
                          </ng-container>
                          <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
                          <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
                        </mat-table>
                      </div>
                    </ng-container>
  
                    <ng-container>
                      <div class="row">
                        <div class="col-md-12 col-sm-12">
                          <button class=" app-add-new-line-btn" type="button" id="bid_add_line" (click)="addBidEvaluationLineClick()">
                            <i class="fas fa-plus" aria-hidden="true"> </i> Add New Line
                          </button>
                        </div>
                      </div>
                    </ng-container>
                  </div>
                </div>
              </div>
            </div>
            <!--bid Lines-->
          </div>
        </div>
  
        <mat-divider class="mt-10"></mat-divider>
  
        <div class="kt-portlet__foot p-5">
          <div class="kt-form__actions kt-form__actions mb-0">
            <div class="row">
              <div class="col-lg-12 text-right">
                <button class="mr-2 app-reset-btn" type="button" (click)="reset()" mat-raised-button id="bid_reset"><i class="fas fa-undo"></i> Reset</button>
                <button class="mr-2 app-reset-btn" mat-raised-button type="submit" id="bid_save"
                  (click)="logValidationErrors(bidEvaluationForm, this.formErrors, this.validationMessages); isSubmit(0)"><i  class="far fa-save"></i> Save</button>
                <button class="app-default-btn" mat-raised-button type="submit" id="bid_submit"
                  (click)="logValidationErrors(bidEvaluationForm, this.formErrors, this.validationMessages); isSubmit(1)"><i  class="far fa-save"></i>
                  Submit
                </button>
              </div>
            </div>
          </div>
        </div>
      </form>
      <!--end::Form-->
    </kt-portlet>
  </div>